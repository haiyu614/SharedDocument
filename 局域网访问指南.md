# 局域网访问指南

## 配置说明

已将应用配置为监听 `0.0.0.0:5000`，允许局域网内其他设备访问。

---

## 第一步：获取本机 IP 地址

在 PowerShell 中执行：
```powershell
ipconfig
```

查找 **"无线局域网适配器 WLAN"** 或 **"以太网适配器"** 下的 **IPv4 地址**，例如：
```
IPv4 地址 . . . . . . . . . . . . : 192.168.1.100
```

---

## 第二步：配置 Windows 防火墙

### 方法A：允许 Python 通过防火墙（推荐）

在 PowerShell（管理员权限）执行：
```powershell
# 允许 Python 入站连接
New-NetFirewallRule -DisplayName "Flask App" -Direction Inbound -Program "C:\Python39\python.exe" -Action Allow

# 或者允许特定端口
New-NetFirewallRule -DisplayName "Flask Port 5000" -Direction Inbound -Protocol TCP -LocalPort 5000 -Action Allow
```

### 方法B：通过图形界面配置

1. 打开 **Windows Defender 防火墙**
2. 点击 **"高级设置"**
3. 选择 **"入站规则"** → **"新建规则"**
4. 选择 **"端口"** → 下一步
5. 选择 **TCP**，输入端口 **5000** → 下一步
6. 选择 **"允许连接"** → 下一步
7. 全选（域、专用、公用）→ 下一步
8. 名称：**Flask App 5000** → 完成

### 方法C：临时关闭防火墙（仅测试用）

```powershell
# 关闭防火墙（不推荐）
Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled False

# 测试完后记得开启
Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True
```

---

## 第三步：启动应用

```powershell
cd c:\Users\Administrator\Desktop\SharedDocument-tchen
python app.py
```

看到输出：
```
* Running on http://0.0.0.0:5000
* Running on http://192.168.1.100:5000
```

---

## 第四步：其他设备访问

### 在同一局域网的其他设备上：

**电脑/手机/平板浏览器打开：**
```
http://192.168.1.100:5000
```
（将 `192.168.1.100` 替换为你的实际 IP 地址）

---

## 测试连接

### 在本机测试
```powershell
# 测试本地访问
curl http://localhost:5000

# 测试局域网访问
curl http://192.168.1.100:5000
```

### 在其他设备测试
- 手机连接同一 WiFi
- 浏览器打开 `http://你的IP:5000`
- 应该能看到登录页面

---

## 常见问题

### Q1: 其他设备无法访问？

**检查清单：**
1. ✅ 确认两台设备在同一局域网（连接同一个路由器/WiFi）
2. ✅ 确认防火墙已允许 5000 端口
3. ✅ 确认应用正在运行
4. ✅ 确认 IP 地址正确

**测试防火墙：**
```powershell
# 查看防火墙规则
Get-NetFirewallRule -DisplayName "*Flask*"

# 测试端口是否开放
Test-NetConnection -ComputerName 192.168.1.100 -Port 5000
```

### Q2: IP 地址经常变化？

**设置静态 IP：**
1. 打开 **"网络和共享中心"**
2. 点击当前网络连接
3. **"属性"** → **"Internet 协议版本 4 (TCP/IPv4)"**
4. 选择 **"使用下面的 IP 地址"**
5. 设置固定 IP（如 192.168.1.100）

或者使用路由器的 DHCP 保留功能。

### Q3: 手机访问很慢？

- 确保手机和电脑距离路由器较近
- 检查 WiFi 信号强度
- 尝试使用 5GHz WiFi（如果支持）

### Q4: WebSocket 连接失败？

确认防火墙没有阻止 WebSocket 连接，WebSocket 使用相同端口（5000）。

---

## 安全建议

### ⚠️ 仅在可信任的局域网使用

- 不要在公共 WiFi 使用
- 不要将端口暴露到公网
- 使用完毕后关闭应用

### 🔒 增强安全性

如果需要长期使用，建议：
1. 配置 HTTPS（自签名证书）
2. 设置强密码
3. 限制访问 IP 范围

---

## 使用场景

### 场景1：团队协作
- 团队成员连接同一办公室 WiFi
- 访问你的电脑进行文档协作
- 实时编辑共享文档

### 场景2：演示展示
- 在会议室演示应用
- 参会者用手机/平板访问
- 实时查看效果

### 场景3：家庭使用
- 家人共享文档
- 多设备访问
- 文件集中管理

---

## 快速命令参考

```powershell
# 1. 查看本机 IP
ipconfig | findstr IPv4

# 2. 开放防火墙端口
New-NetFirewallRule -DisplayName "Flask Port 5000" -Direction Inbound -Protocol TCP -LocalPort 5000 -Action Allow

# 3. 启动应用
cd c:\Users\Administrator\Desktop\SharedDocument-tchen
python app.py

# 4. 测试连接
curl http://localhost:5000
```

---

## 访问地址示例

假设你的 IP 是 `192.168.1.100`：

- **本机访问：** http://localhost:5000
- **局域网访问：** http://192.168.1.100:5000
- **手机访问：** http://192.168.1.100:5000

---

## 停止应用

在运行 `python app.py` 的窗口按 `Ctrl + C`

---

## 进阶：使用二维码分享

可以生成二维码方便手机扫描访问：

```powershell
# 安装 qrcode
pip install qrcode[pil]

# 生成二维码
python -c "import qrcode; qrcode.make('http://192.168.1.100:5000').save('qr.png')"
```

手机扫描 `qr.png` 即可直接访问。
